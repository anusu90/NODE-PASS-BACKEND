<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/24a924ca11.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="CSS/css/bootstrap.css">
    <link rel="stylesheet" href="CSS/passresetcss.css">
    <title id="myTitle"> Password Reset </title>

    <style>
        html {
            font-family: 'Ubuntu', sans-serif;
        }

        .loader {
            /* animation: myAnimation 5s linear infinite; */
            position: absolute;
            margin: auto;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }


        @keyframes myAnimation {

            form {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }
    </style>


</head>

<body style="height: 100vh; width: 100%; position: relative; background-color: whitesmoke">
    &nbsp;

    <div class="container h-100">
        <div class="row h-100 align-items-center">
            <div class="col-md-6 offset-md-3">

                <div class="text-center myTextCenter">
                    <p class="myuser" id="myuser"
                        style="display:inline-block; font-size: 32px; color: rgb(10, 3, 3); font-family:'Ubuntu', sans-serif; margin-left: 10px; text-align: center; width: 100%;">
                        Reset your password
                    </p>
                    <form id="forgotPasswordForm">
                        <div class="form-group">
                            <input type="password" class="form-control" id="forgotPasswordInput"
                                aria-describedby="emailHelp" placeholder="Enter password">
                        </div>

                        <div class="form-group">
                            <input type="password" class="form-control" id="forgotPasswordInputConfirm"
                                placeholder="Confirm Password">
                        </div>
                        <div class="form-group">
                            <span id="statusMessage">  </span>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Submit</button>
                        <button type="reset" class="btn btn-danger">Reset</button>

                    </form>
                </div>
            </div>
        </div>
    </div>


    <script>
        let backendURl = "http://localhost:3002/users"
        let frontendURL = "http://127.0.0.1:5500/JS/NODE-PASSWORD-RESET/NODE_PASS_RES_FRONTEND/index.html"
        let loader = document.getElementById("mySpinner");
        let statusMessage = document.getElementById("statusMessage");

        function displaySatus(message){
            statusMessage.innerHTML = message;
        }

        let forgotPasswordForm = document.getElementById("forgotPasswordForm");
        
        
        forgotPasswordForm.addEventListener("submit", async (e)=> {
            e.preventDefault();
            let forgotPasswordInput = document.getElementById('forgotPasswordInput').value;
            let forgotPasswordInputConfirm = document.getElementById('forgotPasswordInputConfirm').value;
            if(forgotPasswordInput !== forgotPasswordInputConfirm){

                displaySatus("Password dont match");
                
            } else {
                
                displaySatus("");

                console.log(forgotPasswordInput);

                let passwordChangeReset = await fetch(backendURl + "/changeuserpassword", {
                    method: "POST",
                    headers: {
                        'Content-Type': 'application/json',
                        "authorizarion": (localStorage.getItem('sariOkayReset'))?localStorage.getItem('sariOkayReset'):" "
                        // 'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: JSON.stringify({
                        password: forgotPasswordInput
                    })
                })
            }
            
        })



        // setTimeout(() => {

        //     window.open(frontendURL);

        // }, 3000);
    </script>

</body>


</html>